{"version":3,"file":"src_app_pages_checkout_checkout_module_ts.js","mappings":"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","sources":["./src/app/pages/checkout/checkout.page.html","./src/app/pages/checkout/checkout-routing.module.ts","./src/app/pages/checkout/checkout.module.ts","./src/app/pages/checkout/checkout.page.ts"],"sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-button color=\\\"primary\\\" (click)=\\\"back()\\\" routerDirection=\\\"forward\\\">\\n        <ion-icon name=\\\"chevron-back-outline\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content fullscreen=\\\"true\\\">\\n  <h1 class=\\\"title\\\">Checkout</h1>\\n\\n  <div class=\\\"cart-items\\\">\\n    <ng-container *ngFor=\\\"let checkout of checkout\\\">\\n      <div>\\n        <app-checkout-card [checkout]=\\\"checkout\\\"></app-checkout-card>\\n      </div>\\n    </ng-container>\\n  </div>\\n\\n  <hr>\\n\\n  <div class=\\\"cart-total\\\">\\n    <ion-item lines=\\\"none\\\">\\n      <ion-label>Total</ion-label>\\n      <ion-label slot=\\\"end\\\" class=\\\"ion-text-right\\\">RM {{this.total}}</ion-label>\\n    </ion-item>\\n  </div>\\n</ion-content>\\n<ion-footer translucent=\\\"true\\\" class=\\\"ion-no-border\\\" mode=\\\"md\\\">\\n  <ion-toolbar color=\\\"translucent\\\">\\n    <ion-button expand=\\\"block\\\" class=\\\"main-button\\\" routerLink=\\\"/confirm\\\" routerDirection=\\\"forward\\\">Buy</ion-button>\\n  </ion-toolbar>\\n</ion-footer>\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CheckoutPage } from './checkout.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CheckoutPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CheckoutPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { CheckoutPageRoutingModule } from './checkout-routing.module';\n\nimport { CheckoutPage } from './checkout.page';\nimport {SharedModule} from \"../../shared\";\n\n@NgModule({\n    imports: [\n        CommonModule,\n        FormsModule,\n        IonicModule,\n        CheckoutPageRoutingModule,\n        SharedModule\n    ],\n  declarations: [CheckoutPage]\n})\nexport class CheckoutPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport {ProductService} from '../../services/cafe/product.service';\nimport {Router} from '@angular/router';\nimport {doc, Firestore, getDoc, setDoc} from \"@angular/fire/firestore\";\nimport {ICartCard} from \"../../shared\";\nimport {AngularFirestore, DocumentData} from \"@angular/fire/compat/firestore\";\nimport {AuthService} from \"../../services/auth/auth.service\";\nimport {MyCartPage} from \"../my-cart/my-cart.page\";\nimport {MenuController} from \"@ionic/angular\";\n@Component({\n  selector: 'app-checkout',\n  templateUrl: './checkout.page.html',\n  styleUrls: ['./checkout.page.scss'],\n})\n\n\nexport class CheckoutPage implements OnInit {\n\n  total = 0;\n  checkout: ICartCard [] = [\n  ];\n  owner = '';\n  private id = this.ionicAuthService.getUid();\n\n  constructor(\n    private product: ProductService,\n    private router: Router,\n    private afs: AngularFirestore,\n    private _firestore: Firestore,\n    private ionicAuthService: AuthService,\n    private menu: MenuController\n  ) {\n    this.menu.enable(false);\n  }\n  async ionViewDidLeave() {\n    await this.menu.enable(true);\n  }\n\n  ngOnInit() {\n    this.addItemsToCart();\n  }\n\n  async addItemsToCart() {\n    let data: DocumentData;\n    this.total = 0;\n    // eslint-disable-next-line no-underscore-dangle\n    const itemIdRef = doc(this._firestore, `carts/${(this.id)}`);\n    await getDoc(itemIdRef)\n      .then(snap =>   { data = snap.data(); delete data.lastUpdate; delete data.id;});\n    for (const key in data) {\n      console.log(key);\n      const idOwnerRef = doc(this._firestore, `idOwner/${(key.split('@')[0])}`);\n      const idOwnerSnap = await getDoc(idOwnerRef);\n      const idOwnerName = idOwnerSnap.data();\n      this.owner = idOwnerName.owner;\n      console.log(this.owner);\n      const ownerRef = doc(this._firestore, `stores/${(this.owner)}`);\n      const ownerSnap = await getDoc(ownerRef);\n      const ownerName = ownerSnap.data();\n      // eslint-disable-next-line no-underscore-dangle\n      const dataRef = doc(this._firestore, `stores/${(this.owner)}/items/${(key.split('@')[0])}`);\n      const docSnap = await getDoc(dataRef);\n      const dataSnap = docSnap.data();\n      const value = data[key];\n      const keys = key.split('@')[1].split('-').slice(0, -1);\n      let optionSnap = 0;\n      for (const price of keys) {\n        // eslint-disable-next-line max-len\n        const optionRef = doc(this._firestore, `stores/${(this.owner)}/items/${(key.split('@')[0])}/optionPrice/${(price)}`);\n        const optSnap = await getDoc(optionRef);\n        optionSnap += Number(optSnap.data().price);\n      }\n      this.checkout.push(\n        {\n          name: dataSnap.name,\n          owner: ownerName.name,\n          price: Number(dataSnap.price)+ optionSnap,\n          image: dataSnap.imageUrl,\n          id: key,\n          ownerId: this.owner,\n          quantity: value,\n        },\n      );\n      this.total += (Number(dataSnap.price)+optionSnap)*value;\n    }\n  }\n\n  back() {\n    this.router.navigateByUrl('tabs/home', {replaceUrl: true});\n  }\n\n}\n"],"names":[],"sourceRoot":"webpack:///"}