{"version":3,"file":"default-src_app_shared_components_modal_add-item_add-item_component_ts.js","mappings":"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","sources":["./src/app/shared/components/modal/add-item/add-item.component.html","./src/app/shared/components/modal/add-item/add-item.component.ts"],"sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-button color=\\\"primary\\\" (click)=\\\"back()\\\" routerDirection=\\\"forward\\\">\\n        <ion-text>Cancel</ion-text>\\n      </ion-button>\\n    </ion-buttons>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button\\n        *ngIf=\\\"!isLoading\\\"\\n        color=\\\"primary\\\"\\n        (click)=\\\"onSubmit()\\\">\\n        <ion-text style=\\\"font-weight: bold\\\">Confirm</ion-text>\\n      </ion-button>\\n      <ion-button\\n        *ngIf=\\\"isLoading\\\">\\n        <ion-spinner color=\\\"primary\\\"></ion-spinner>\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content fullscreen=\\\"true\\\">\\n  <div class=\\\"ion-padding\\\">\\n    <ion-row style=\\\"padding-left: 0\\\">\\n      <ion-col size=\\\"10\\\">\\n        <ion-text  color=\\\"primary\\\" style=\\\"font-size: 26px; font-weight: bold\\\">Add New Item</ion-text>\\n      </ion-col>\\n    </ion-row>\\n    <ion-card>\\n      <div class=\\\"ion-padding\\\">\\n    <div>\\n      <form method=\\\"post\\\" enctype=\\\"multipart/form-data\\\">\\n        <div>\\n          <div><b>Upload a photo for your item.</b></div><br/>\\n          <input type=\\\"file\\\" (change)=\\\"uploadPhoto($event)\\\" accept=\\\".png,.jpg\\\" multiple=\\\"true\\\"/>\\n          <div *ngIf=\\\"errorMessage\\\">\\n            <ion-text color=\\\"danger\\\">\\n              <ion-text\\n                class=\\\"error\\\">* {{errorMessage}}</ion-text>\\n            </ion-text>\\n          </div>\\n        </div>\\n      </form>\\n    </div>\\n    <div *ngIf=\\\"barStatus\\\">\\n      Uploading.....\\n    </div>\\n    <div id=\\\"photoPreview\\\">\\n      <div *ngFor=\\\"let image of imageUploads\\\">\\n        <img loading=\\\"lazy\\\" [src]=\\\"image\\\" class=\\\"preview\\\"/>\\n      </div>\\n    </div>\\n      </div>\\n    </ion-card>\\n    <form [formGroup]=\\\"form\\\" class=\\\"ion-margin\\\">\\n      <div class=\\\"ion-margin-vertical\\\">\\n        <ion-item lines=\\\"full\\\">\\n          <ion-input formControlName=\\\"name\\\" [type]=\\\"type ? 'text' : 'text'\\\" placeholder=\\\"Enter item name\\\"></ion-input>\\n        </ion-item>\\n        <ion-text\\n          color=\\\"danger\\\"\\n          *ngIf=\\\"!form.get('name').valid && form.get('name').touched\\\">\\n          <ion-text\\n            class=\\\"error\\\"\\n            *ngIf=\\\"form.get('name').hasError('required')\\\">\\n            * Please enter the store name\\n          </ion-text>\\n        </ion-text>\\n      </div>\\n      <div class=\\\"ion-margin-vertical\\\">\\n        <ion-item lines=\\\"full\\\">\\n          <ion-input formControlName=\\\"price\\\" [type]=\\\"type ? 'number' : 'number'\\\" placeholder=\\\"Enter price\\\"></ion-input>\\n        </ion-item>\\n        <ion-text\\n          color=\\\"danger\\\"\\n          *ngIf=\\\"!form.get('price').valid && form.get('price').touched\\\">\\n          <ion-text\\n            class=\\\"error\\\"\\n            *ngIf=\\\"form.get('price').hasError('required')\\\">\\n            * Please enter the price\\n          </ion-text>\\n        </ion-text>\\n      </div>\\n      <div class=\\\"ion-margin-vertical\\\">\\n        <ion-item lines=\\\"full\\\">\\n          <ion-input formControlName=\\\"category\\\" [type]=\\\"type ? 'text' : 'text'\\\" placeholder=\\\"Enter category\\\"></ion-input>\\n        </ion-item>\\n        <ion-text\\n          color=\\\"danger\\\"\\n          *ngIf=\\\"!form.get('category').valid && form.get('category').touched\\\">\\n          <ion-text\\n            class=\\\"error\\\"\\n            *ngIf=\\\"form.get('category').hasError('required')\\\">\\n            * Please enter the category\\n          </ion-text>\\n        </ion-text>\\n        <div class=\\\"ion-margin-vertical\\\">\\n          <ion-item lines=\\\"full\\\">\\n            <ion-input formControlName=\\\"description\\\" [type]=\\\"type ? 'text' : 'text'\\\" placeholder=\\\"Enter description\\\"></ion-input>\\n          </ion-item>\\n          <ion-text\\n            color=\\\"danger\\\"\\n            *ngIf=\\\"!form.get('description').valid && form.get('description').touched\\\">\\n            <ion-text\\n              class=\\\"error\\\"\\n              *ngIf=\\\"form.get('description').hasError('required')\\\">\\n              * Please enter the description\\n            </ion-text>\\n          </ion-text>\\n        </div>\\n      </div>\\n    </form>\\n    <ion-item *ngFor=\\\"let customOption of this.product.customOptions\\\">\\n      <div class=\\\"title\\\">\\n        <h2 color=\\\"primary\\\">Current Customisation</h2>\\n      </div>\\n      <ion-card mode=\\\"ios\\\" class=\\\"ion-padding\\\">\\n        <ion-row>\\n          <ion-col size=\\\"10\\\">\\n            <ion-card-title style=\\\"font-size: 18px; padding-top: 3px\\\" >{{customOption.name}}</ion-card-title>\\n          </ion-col>\\n          <ion-col size=\\\"2\\\" class=\\\"ion-text-right\\\">\\n            <ion-buttons>\\n              <ion-button (click)=\\\"openCustomiseOrderModal(customOption.name)\\\">\\n                <ion-icon name=\\\"pencil-outline\\\"></ion-icon>\\n              </ion-button>\\n            </ion-buttons>\\n          </ion-col>\\n        </ion-row>\\n      </ion-card>\\n    </ion-item>\\n  </div>\\n</ion-content>\\n\\n\";","import { Component, OnInit } from '@angular/core';\nimport {FormControl, FormGroup, Validators} from '@angular/forms';\nimport {FirebaseUploadService} from '../../../../services/cafe/firebase-upload.service';\nimport {Router} from '@angular/router';\nimport {collection, doc, Firestore, getDocs, query, setDoc} from '@angular/fire/firestore';\nimport {AuthService} from '../../../../services/auth/auth.service';\nimport {AngularFirestore} from '@angular/fire/compat/firestore';\nimport {AlertController, ModalController} from '@ionic/angular';\nimport {IFoodCard} from '../../cards';\nimport {CustomiseOrderPage} from '../customise-order/customise-order.page';\nimport {ProductService} from \"../../../../services/cafe/product.service\";\nimport {StorageService} from \"../../../../services/storage.service\";\n\n@Component({\n  selector: 'app-add-item',\n  templateUrl: './add-item.component.html',\n  styleUrls: ['./add-item.component.scss'],\n})\nexport class AddItemComponent implements OnInit {\n\n  barStatus = false;\n  errorMessage = '';\n  imageUploads = [];\n  name = '';\n  form: FormGroup;\n  type = false;\n  isLoading: boolean;\n  imageUrl = '';\n  foodStore: IFoodCard[] = [\n  ];\n  object = Object;\n  private uid = this.ionicAuthService.getUid();\n\n\n  constructor(private firebaseUploadService: FirebaseUploadService,\n              private router: Router,\n              private _firestore: Firestore,\n              private ionicAuthService: AuthService,\n              private afs: AngularFirestore,\n              private modalController: ModalController,\n              private alertController: AlertController,\n              private product: ProductService,\n              private storage: StorageService) {\n    this.initForm();\n  }\n\n  ngOnInit() {\n  }\n\n  async openCustomiseOrderModal(nameInput) {\n    const name = nameInput;\n    for (const key in  this.product.customOptions) {\n      if (this.product.customOptions[key].name === name) {\n        this.product.customOption = this.product.customOptions[key].data;\n        console.log(this.product.customOption);\n        this.product.customNew = false;\n      }\n    }\n    const modal = await this.modalController.create({\n      component: CustomiseOrderPage,\n      swipeToClose: true,\n      presentingElement: await this.modalController.getTop()\n    });\n    return await modal.present();\n  }\n\n  uploadPhoto(event) {\n    this.barStatus = true;\n    this.firebaseUploadService.storeImage(event.target.files[0]).then(\n      (res: any) => {\n        if (res) {\n          console.log(res);\n          this.imageUrl = res;\n          this.imageUploads = [];\n          this.imageUploads.unshift(res);\n          this.barStatus = false;\n        }\n      },\n      (error: any) => {\n        this.errorMessage = 'File size exceeded. Maximum file size 1 MB';\n        this.barStatus = false;\n      }\n    );\n  }\n\n  initForm() {\n    this.form = new FormGroup({\n      name: new FormControl(null, {validators: [Validators.required]}),\n      price: new FormControl(null, {validators: [Validators.required]}), // added email validator also\n      category: new FormControl(null, {validators: [Validators.required]}), // added email validator also\n      description: new FormControl(null, {validators: [Validators.required]}), // added email validator also\n    });\n  }\n\n  changeType() {\n    this.type = !this.type;\n  }\n\n  async onSubmit() {\n    if(!this.form.valid) {\n      this.form.markAllAsTouched();\n      return;\n    }\n    if(this.imageUrl === '') {\n      this.errorMessage = 'You must upload an image for your item to proceed.';\n      return;\n    }\n    this.isLoading = true;\n    console.log(this.form.value);\n    await this.uploadStoreDetails(this.form.value);\n    await this.showAlert('Adding Item', 'Item successfully added.');\n    this.isLoading = false;\n    await this.modalController.dismiss();\n  }\n\n  async uploadStoreDetails(formValue) {\n    // eslint-disable-next-line no-underscore-dangle\n    const pushKey = this.afs.createId();\n    let dataRef = doc(this._firestore, `stores/${(this.uid)}/items/${(pushKey)}`);\n    await setDoc(dataRef, {\n      name: formValue.name,\n      price: formValue.price,\n      category: formValue.category,\n      description: formValue.description,\n      imageUrl: this.imageUrl,\n      status: 'available',\n      id: pushKey\n    });\n    dataRef = doc(this._firestore, `idOwner/${(pushKey)}`);\n    await setDoc(dataRef, {\n      owner: this.uid,\n    });\n    // create categories\n    dataRef = doc(this._firestore, `stores/${(this.uid)}/categories/${(formValue.category)}`);\n    await setDoc(dataRef, {\n      name: formValue.category,\n    });\n    // add items to categories\n    await this.afs.collection(`stores/${(this.uid)}/categories/`).doc(formValue.category).update({\n      [pushKey]: 1,\n    });\n    dataRef = doc(this._firestore, `idOwner/${(pushKey)}`);\n    await setDoc(dataRef, {\n      owner: this.uid,\n    });\n    if (this.product.customOptions !== []) {\n      for (const key in this.product.customOptions) {\n        dataRef = doc(this._firestore, `stores/${(this.uid)}/items/${(pushKey)}/options/${(this.product.customOptions[key].name)}`);\n        await setDoc(dataRef, this.product.customOptions[key].data);\n      }\n    }\n  }\n\n  async back() {\n    await this.modalController.dismiss();\n  }\n\n  async showAlert(header,message) {\n    const alert = await this.alertController.create({\n      header,\n      message,\n      buttons: ['OK'],\n    });\n\n    await alert.present();\n  }\n}\n"],"names":[],"sourceRoot":"webpack:///"}